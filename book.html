<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Envy Lashes</title>
  
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css" />
  <!-- Swiper CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <!-- Font Awesome -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    integrity="sha512-v4VldC0gCmW0b6M5E8fZd1mU86S/Jc8hUtZ2q0Oe2xdYIjrXTxEqYFJtO0qYYwAvFFK0TTZWIX1z0UgR6Vd0hg=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <!-- BoxIcons -->
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-3LBO4V2+KXsNxNGCjBSM6qgQxfuj+08X4uQIPXe5lASgu0SYkJ8z9tWrKuG1fqtp"
    crossorigin="anonymous"
/>


  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #ffffff, #ffffff);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
    }


    .booking-container {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 15px 40px rgba(228, 90, 132, 0.2);
      max-width: 500px;
      width: 100%;
      transition: box-shadow 0.3s ease;
      animation: fadeIn 0.7s ease-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    h1 {
      color: #e45a84;
      font-size: 2.2rem;
      text-align: center;
      margin-bottom: 8px;
    }

    .service-name {
      text-align: center;
      font-weight: 500;
      color: #333;
      margin-bottom: 28px;
      font-size: 1.1rem;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .input-group {
      position: relative;
    }

    .input-group input,
    .input-group select {
      width: 100%;
      padding: 14px 12px;
      border: 1px solid #ddd;
      border-radius: 10px;
      background: #fdfdfd;
      font-size: 0.95rem;
      transition: border-color 0.3s, box-shadow 0.3s;
    }

    .input-group input:focus,
    .input-group select:focus {
      border-color: #e45a84;
      outline: none;
      box-shadow: 0 0 8px rgba(228, 90, 132, 0.2);
    }

    .input-group label {
      position: absolute;
      left: 12px;
      top: 14px;
      background: white;
      padding: 0 4px;
      font-size: 0.9rem;
      color: #999;
      transition: 0.2s;
      pointer-events: none;
    }

    .input-group input:focus + label,
    .input-group input:not(:placeholder-shown) + label,
    .input-group select:valid + label {
      top: -8px;
      left: 10px;
      font-size: 0.75rem;
      color: #e45a84;
    }

    button {
      padding: 14px;
      background: linear-gradient(145deg, #e45a84, #ff90b6);
      border: none;
      border-radius: 12px;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.3s ease;
      box-shadow: 0 8px 20px rgba(228, 90, 132, 0.3);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 24px rgba(228, 90, 132, 0.4);
    }

    button:active {
      transform: scale(0.97);
    }

    @media (max-width: 540px) {
      .booking-container {
        padding: 30px 20px;
      }

      h1 {
        font-size: 1.8rem;
      }
    }

    
  </style>


</head>
<body>
    <!-- NavBar -->
<header>
  <a href="#" class="logo"><h2>Envy<span>Lashes</h2></a>
  <!-- Hamburger icon -->
  <div class="bx" id="menu-icon">&#9776;</div>

  <!-- Sidebar menu (hidden by default) -->
<nav class="navbar" id="navbar">
  <div class="nav-dropdown">
    <a href="index.html" class="home-link">Home</a>
</div>
<a href="index.html#reviews">Reviews</a>
  <a href="mywork.html">My Work</a>
  <a href="prices.html">Prices</a>
  <a href="policies.html">Policies</a>
  <a href="hours.html">Hours</a>
  <a href="contact.html">Contact</a>
</nav>
</header>


  <div class="booking-container">
    <h1>Book Your Appointment</h1>
    <div class="service-name" id="selectedService">Loading...</div>

    <form id="bookingForm">
      <input type="hidden" name="service" id="serviceInput" />

      <div class="input-group">
        <input type="text" name="Name" id="name" placeholder=" " required />
        <label for="name">Full Name</label>
      </div>

      <div class="input-group">
        <input type="email" name="Email" id="email" placeholder=" " required />
        <label for="email">Email</label>
      </div>

      <div class="input-group">
        <input type="tel" name="Phone" id="phone" placeholder=" " required />
        <label for="phone">Phone Number</label>
      </div>

      <div class="input-group">
        <input type="date" name="Date" id="dateInput" required />
        <label for="dateInput">Date</label>
      </div>

      <div class="input-group">
        <select name="Time" id="timeSelect" required>
          <option value="" disabled selected>Select Time</option>
        </select>
        <label
          style="top:-8px; left:10px; font-size: 0.75rem; color:#e45a84;"
          >Time</label
        >
      </div>

      <button type="submit">Confirm Booking</button>
    </form>

    <p
      id="bookingStatus"
      style="text-align:center; margin-top:1rem; font-weight:bold;"
    ></p>
  </div>

  <!-- EmailJS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<script>
  // Initialize EmailJS
  emailjs.init('QQVbC9xiRo775QVY2'); // Replace with your EmailJS public key

  const allowedTimes = {
    weekday: ['09:00', '12:00', '15:00', '18:00'], // Mon–Fri
    saturday: ['16:30', '19:00'],                 // Saturday
  };

  const dateInput = document.getElementById('dateInput');
  const timeSelect = document.getElementById('timeSelect');
  const bookingForm = document.getElementById('bookingForm');
  const bookingStatus = document.getElementById('bookingStatus');

  // Block past dates and Sundays
  const today = new Date().toISOString().split('T')[0];
  dateInput.setAttribute('min', today);

  // Disable Sundays in calendar
  dateInput.addEventListener('input', () => {
    const selectedDate = new Date(dateInput.value);
    if (selectedDate.getDay() === 0) {
      alert("We're closed on Sundays. Please select another date.");
      dateInput.value = '';
      timeSelect.innerHTML =
        '<option value="" disabled selected>Select Time</option>';
    }
  });

  // Load service from URL params
  const params = new URLSearchParams(window.location.search);
  const service = params.get('service') || 'Unknown Service';
  document.getElementById('selectedService').textContent = `Service: ${service}`;
  document.getElementById('serviceInput').value = service;

  function getBookings() {
    return JSON.parse(localStorage.getItem('envyBookings') || '[]');
  }

  function saveBookings(bookings) {
    localStorage.setItem('envyBookings', JSON.stringify(bookings));
  }

  function isBooked(date, time) {
    const bookings = getBookings();
    return bookings.some((b) => b.date === date && b.time === time);
  }

  dateInput.addEventListener('change', () => {
    const selectedDate = dateInput.value;
    if (!selectedDate) {
      timeSelect.innerHTML =
        '<option value="" disabled selected>Select Time</option>';
      return;
    }

    const day = new Date(selectedDate).getDay(); // 0 = Sunday, 6 = Saturday

    let times = [];

    if (day === 0) {
      // Saturday
      times = allowedTimes.saturday;
    } else if ([1, 2, 3, 4, 5].includes(day)) {
      // Monday–Friday
      times = allowedTimes.weekday;
    } else {
      // Sunday should not be reachable because of earlier alert, but handle fallback
      timeSelect.innerHTML =
        '<option value="" disabled selected>Closed on Sundays</option>';
      return;
    }

    timeSelect.innerHTML =
      '<option value="" disabled selected>Select Time</option>';

    times.forEach((time) => {
      if (!isBooked(selectedDate, time)) {
        const option = document.createElement('option');
        option.value = time;
        option.textContent = formatTimeDisplay(time);
        timeSelect.appendChild(option);
      }
    });
  });

  function formatTimeDisplay(time) {
    const [h, m] = time.split(':').map(Number);
    const suffix = h >= 12 ? 'PM' : 'AM';
    const hour = h % 12 === 0 ? 12 : h % 12;
    return `${hour}:${m.toString().padStart(2, '0')} ${suffix}`;
  }

  bookingForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    bookingStatus.textContent = '';
    bookingStatus.style.color = '';

    const booking = {
      service: document.getElementById('serviceInput').value,
      name: document.getElementById('name').value.trim(),
      email: document.getElementById('email').value.trim(),
      phone: document.getElementById('phone').value.trim(),
      date: dateInput.value,
      time: timeSelect.value,
    };

    if (!booking.time) {
      alert('Please select a time.');
      return;
    }

    if (isBooked(booking.date, booking.time)) {
      alert('This time slot is already booked. Please choose another time.');
      return;
    }

    const bookings = getBookings();
    bookings.push(booking);
    saveBookings(bookings);

    try {
      await emailjs.send('service_63rbqv31asd', 'template_gffz4d9', booking);
    } catch (err) {
      console.error('EmailJS error:', err);
    }

    try {
      await fetch('/.netlify/functions/sendSMS', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(booking),
      });
    } catch (err) {
      console.error('SMS sending error:', err);
    }

    bookingStatus.textContent =
      'Booking confirmed! You will receive a confirmation shortly.';
    bookingStatus.style.color = 'green';

    bookingForm.reset();
    timeSelect.innerHTML =
      '<option value="" disabled selected>Select Time</option>';
  });

  // Mobile menu toggle
  document.querySelectorAll('.dropdown-toggle').forEach(function (toggle) {
    toggle.addEventListener('click', function (e) {
      e.preventDefault();
      const parent = this.closest('.nav-dropdown');
      parent.classList.toggle('open');
    });
  });
</script>


  <!-- Bootstrap Bundle JS -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
    crossorigin="anonymous"
  ></script>
  <!-- Swiper JS -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <!-- Your main JS -->
  <script src="main.js"></script>
  <script>
 
  </script>
  
</body>

</html>
